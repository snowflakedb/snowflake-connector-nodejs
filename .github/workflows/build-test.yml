name: Build and Test

on: push
jobs:
    build-test:
        name: Build and Test Job
        runs-on: ubuntu-16.04
        strategy:
            matrix:
                node-version: [ '10.x' ]
        steps:
            - uses: actions/checkout@v1
            - name: Setup Node
              uses: actions/setup-node@v1
              with:
                node-version: ${{ matrix.node-version }}
                architecture: x64
            - name: Build
              shell: bash
              run: ./ci/build.sh
            - name: Tests
              shell: bash
              env:
                PARAMETERS_SECRET: ${{ secrets.PARAMETERS_SECRET }}
              run: ./ci/test.sh
            - name: Upload Test results
              if: always()
              uses: actions/upload-artifact@v1
              with:
                name: junit.xml
                path: junit.xml
